#! /bin/bash
set -e 

APP_NAME=mattthorningphotography
BRANCH=typescript

scp ./.env vps:~/containers/$APP_NAME/$APP_NAME

ssh vps << EOF
    cd ~/containers/$APP_NAME/$APP_NAME
    git checkout $BRANCH
    git pull
    docker-compose up -d --build --force-recreate --remove-orphans
    echo "y" | docker container prune
    echo "y" | docker image prune
EOF
